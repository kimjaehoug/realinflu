# μΈν”λ£¨μ—”μ μ •λ³΄ ν¬ν„Έ (Influenza Dashboard)

μ§λ³‘κ΄€λ¦¬μ²­ μΈν”λ£¨μ—”μ μ •λ³΄ ν¬ν„Έμ React ν”„λ΅ νΈμ—”λ“ μ• ν”λ¦¬μΌ€μ΄μ…μ…λ‹λ‹¤. μ‹¤μ‹κ°„ μΈν”λ£¨μ—”μ λ°μ΄ν„°λ¥Ό μ‹κ°ν™”ν•κ³  λ¶„μ„ν•λ” λ€μ‹λ³΄λ“λ¥Ό μ κ³µν•©λ‹λ‹¤.

## π“‹ λ©μ°¨

- [μ£Όμ” κΈ°λ¥](#μ£Όμ”-κΈ°λ¥)
- [κΈ°μ  μ¤νƒ](#κΈ°μ -μ¤νƒ)
- [ν”„λ΅μ νΈ κµ¬μ΅°](#ν”„λ΅μ νΈ-κµ¬μ΅°)
- [μ„¤μΉ λ° μ‹¤ν–‰](#μ„¤μΉ-λ°-μ‹¤ν–‰)
- [ν™κ²½ λ³€μ μ„¤μ •](#ν™κ²½-λ³€μ-μ„¤μ •)
- [API μ—°λ™](#api-μ—°λ™)
- [μ£Όμ” μ»΄ν¬λ„νΈ](#μ£Όμ”-μ»΄ν¬λ„νΈ)
- [κ°λ° κ°€μ΄λ“](#κ°λ°-κ°€μ΄λ“)

## π― μ£Όμ” κΈ°λ¥

- π“ **μΈν”λ£¨μ—”μ λ°μ΄ν„° λ€μ‹λ³΄λ“**: μ‹¤μ‹κ°„ μΈν”λ£¨μ—”μ λ°μƒλ¥  λ° ν†µκ³„ λ°μ΄ν„° μ‹κ°ν™”
- π“ **λ‹¤μ–‘ν• μ°¨νΈ**: ILI, ARI, SARI, IRISS, KRISS, NEDIS λ“± λ‹¤μ–‘ν• μ§€ν‘λ¥Ό μ°¨νΈλ΅ ν‘μ‹
- π”„ **μ κΈ°/μ£Όμ°¨λ³„ ν•„ν„°λ§**: μΈν”λ£¨μ—”μ μ‹μ¦λ³„ λ°μ΄ν„° μ΅°ν λ° λ¶„μ„
- π¨ **λ°μ‘ν• μ‚¬μ΄λ“λ°”**: μ ‘κΈ°/νΌμΉκΈ° κΈ°λ¥μ΄ μλ” μ‚¬μ΄λ“λ°” λ„¤λΉ„κ²μ΄μ…
- π” **Keycloak μΈμ¦**: OAuth2 κΈ°λ° μΈμ¦ μ‹μ¤ν… μ—°λ™
- π **CORS ν”„λ΅μ‹**: κ°λ° ν™κ²½μ—μ„ CORS λ¬Έμ  ν•΄κ²°μ„ μ„ν• ν”„λ΅μ‹ μ„¤μ •

## π›  κΈ°μ  μ¤νƒ

### Frontend
- **React 18.2.0** - UI λΌμ΄λΈλ¬λ¦¬
- **Material-UI (MUI) 5.14.20** - UI μ»΄ν¬λ„νΈ λΌμ΄λΈλ¬λ¦¬
- **Chart.js 4.5.1** & **react-chartjs-2 5.3.1** - μ°¨νΈ μ‹κ°ν™”
- **Axios 1.6.2** - HTTP ν΄λΌμ΄μ–ΈνΈ
- **react-icons 5.5.0** - μ•„μ΄μ½ λΌμ΄λΈλ¬λ¦¬

### Development Tools
- **http-proxy-middleware 2.0.6** - κ°λ° μ„λ²„ ν”„λ΅μ‹
- **react-scripts 5.0.1** - Create React App λΉλ“ λ„κµ¬

## π“ ν”„λ΅μ νΈ κµ¬μ΅°

```
src/
β”β”€β”€ api/                    # API κ΄€λ ¨ νμΌ
β”‚   β”β”€β”€ auth.js            # Keycloak μΈμ¦ λ΅μ§
β”‚   β”β”€β”€ config.js          # Axios μ„¤μ • λ° μΈν„°μ…‰ν„°
β”‚   β”β”€β”€ etlDataApi.js      # ETL λ°μ΄ν„° API ν•¨μ
β”‚   β””β”€β”€ influenzaApi.js    # μΈν”λ£¨μ—”μ λ°μ΄ν„° API ν•¨μ
β”‚
β”β”€β”€ components/            # React μ»΄ν¬λ„νΈ
β”‚   β”β”€β”€ Dashboard.js       # λ©”μΈ λ€μ‹λ³΄λ“ μ»΄ν¬λ„νΈ
β”‚   β”β”€β”€ Header.js          # ν—¤λ” μ»΄ν¬λ„νΈ
β”‚   β”β”€β”€ Sidebar.js         # μ‚¬μ΄λ“λ°” λ„¤λΉ„κ²μ΄μ… μ»΄ν¬λ„νΈ
β”‚   β””β”€β”€ Footer.js          # ν‘Έν„° μ»΄ν¬λ„νΈ
β”‚
β”β”€β”€ hooks/                 # μ»¤μ¤ν…€ React ν›…
β”‚   β””β”€β”€ useInfluenzaData.js  # μΈν”λ£¨μ—”μ λ°μ΄ν„° νμΉ­ ν›…
β”‚
β”β”€β”€ utils/                 # μ ν‹Έλ¦¬ν‹° ν•¨μ
β”‚   β”β”€β”€ dateUtils.js       # λ‚ μ§ κ³„μ‚° μ ν‹Έλ¦¬ν‹°
β”‚   β””β”€β”€ dataProcessors.js # λ°μ΄ν„° μ²λ¦¬ μ ν‹Έλ¦¬ν‹°
β”‚
β”β”€β”€ App.js                 # λ©”μΈ μ•± μ»΄ν¬λ„νΈ
β”β”€β”€ App.css                # μ•± μ¤νƒ€μΌ
β”β”€β”€ index.js               # μ§„μ…μ 
β”β”€β”€ index.css              # κΈ€λ΅λ² μ¤νƒ€μΌ
β””β”€β”€ setupProxy.js          # κ°λ° μ„λ²„ ν”„λ΅μ‹ μ„¤μ •
```

## π€ μ„¤μΉ λ° μ‹¤ν–‰

### ν•„μ μ”κµ¬μ‚¬ν•­

- **Node.js** 16.x μ΄μƒ
- **npm** λλ” **yarn**

### μ„¤μΉ

```bash
# μμ΅΄μ„± ν¨ν‚¤μ§€ μ„¤μΉ
npm install
```

### κ°λ° μ„λ²„ μ‹¤ν–‰

```bash
npm start
```

κ°λ° μ„λ²„κ°€ μ‹¤ν–‰λλ©΄ λΈλΌμ°μ €μ—μ„ [http://localhost:5090](http://localhost:5090)μ„ μ—΄μ–΄ ν™•μΈν•μ„Έμ”.

### ν”„λ΅λ•μ… λΉλ“

```bash
npm run build
```

ν”„λ΅λ•μ… λΉλ“κ°€ `build` ν΄λ”μ— μƒμ„±λ©λ‹λ‹¤.

## β™οΈ ν™κ²½ λ³€μ μ„¤μ •

ν”„λ΅μ νΈ λ£¨νΈμ— `.env` νμΌμ„ μƒμ„±ν•κ³  λ‹¤μ ν™κ²½ λ³€μλ¥Ό μ„¤μ •ν•μ„Έμ”:

```env
# Keycloak μΈμ¦ μ„¤μ •
REACT_APP_KEYCLOAK_SERVER_URL=https://keycloak.211.238.12.60.nip.io:8100
REACT_APP_KEYCLOAK_REALM=gfid-api
REACT_APP_CLIENT_ID=Vital_Analyzer_accessor
REACT_APP_CLIENT_SECRET=XbY2WJJZ6eA43hlipQg772dZ8hdOeKLE

# API μ„¤μ •
REACT_APP_API_URL=http://211.238.12.60:8084/data/api/v1
REACT_APP_DSID=ds_0101
```

### ν™κ²½ λ³€μ μ„¤λ…

- `REACT_APP_KEYCLOAK_SERVER_URL`: Keycloak μ„λ²„ URL
- `REACT_APP_KEYCLOAK_REALM`: Keycloak Realm μ΄λ¦„
- `REACT_APP_CLIENT_ID`: Keycloak Client ID
- `REACT_APP_CLIENT_SECRET`: Keycloak Client Secret
- `REACT_APP_API_URL`: λ°±μ—”λ“ API κΈ°λ³Έ URL
- `REACT_APP_DSID`: κΈ°λ³Έ λ°μ΄ν„°μ…‹ ID

## π” API μ—°λ™

### μΈμ¦ ν”λ΅μ°

1. **Keycloak Client Credentials Grant**: μ• ν”λ¦¬μΌ€μ΄μ…μ΄ Keycloakμ—μ„ μ•΅μ„Έμ¤ ν† ν°μ„ λ°›μµλ‹λ‹¤.
2. **ν† ν° μ €μ¥**: λ°›μ€ ν† ν°μ€ `localStorage`μ— μ €μ¥λλ©°, λ§λ£ μ‹κ°„λ„ ν•¨κ» μ €μ¥λ©λ‹λ‹¤.
3. **μλ™ κ°±μ‹ **: ν† ν°μ΄ λ§λ£λλ©΄ μλ™μΌλ΅ μƒ ν† ν°μ„ μ”μ²­ν•©λ‹λ‹¤.
4. **API μ”μ²­**: λ¨λ“  API μ”μ²­μ— Bearer ν† ν°μ΄ μλ™μΌλ΅ ν¬ν•¨λ©λ‹λ‹¤.

### API μ—”λ“ν¬μΈνΈ

#### ETL λ°μ΄ν„° μ΅°ν

```javascript
// λ‚ μ§ λ²”μ„λ΅ λ°μ΄ν„° μ΅°ν
GET /etl_data/id/{dsid}/from/{from}/to/{to}

// μµκ·Ό λ°μ΄ν„° μ΅°ν
GET /etl_data/id/{dsid}/recent/{cnt}
```

### ν”„λ΅μ‹ μ„¤μ •

κ°λ° ν™κ²½μ—μ„ CORS λ¬Έμ λ¥Ό ν•΄κ²°ν•κΈ° μ„ν•΄ `setupProxy.js`λ¥Ό μ‚¬μ©ν•©λ‹λ‹¤:

- **Keycloak ν”„λ΅μ‹**: `/keycloak-proxy` β†’ Keycloak μ„λ²„
- **API ν”„λ΅μ‹**: `/api-proxy` β†’ λ°±μ—”λ“ API μ„λ²„

## π§© μ£Όμ” μ»΄ν¬λ„νΈ

### Dashboard

λ©”μΈ λ€μ‹λ³΄λ“ μ»΄ν¬λ„νΈλ΅ λ‹¤μ κΈ°λ¥μ„ μ κ³µν•©λ‹λ‹¤:

- μΈν”λ£¨μ—”μ λ°μ΄ν„° μ‹κ°ν™” (ILI, ARI, SARI, IRISS, KRISS, NEDIS)
- μ κΈ°/μ£Όμ°¨λ³„ λ°μ΄ν„° ν•„ν„°λ§
- μ£Όκ°„ λ³€ν™”μ¨ κ³„μ‚° λ° ν‘μ‹
- μ ν–‰ λ‹¨κ³„ ν‘μ‹ (κ΄€μ‹¬/μ£Όμ/μ ν–‰)
- Feature Importance μ •λ³΄ ν‘μ‹

### Sidebar

μ ‘κΈ°/νΌμΉκΈ° κΈ°λ¥μ΄ μλ” μ‚¬μ΄λ“λ°” λ„¤λΉ„κ²μ΄μ…:

- λ©”λ‰΄ μ•„μ΄μ½ ν΄λ¦­μΌλ΅ μ‚¬μ΄λ“λ°” ν† κΈ€
- λ©”λ‰΄ ν•­λ©: λ€μ‹λ³΄λ“, κ°μ—Όλ³‘ λ‰΄μ¤, μ£Όκ°„ λ°μƒ λ™ν–¥, μΈν”λ£¨μ—”μλ€?, κ·Όμ² λ³‘μ›μ°ΎκΈ°
- μ ‘ν μƒνƒμ—μ„λ„ ν΄νμΌλ΅ λ©”λ‰΄ μ΄λ¦„ ν™•μΈ κ°€λ¥

### useInfluenzaData Hook

μΈν”λ£¨μ—”μ λ°μ΄ν„°λ¥Ό κ°€μ Έμ¤λ” μ»¤μ¤ν…€ ν›…:

```javascript
const { influenzaData, loading, error } = useInfluenzaData(
  selectedSeason,  // μ κΈ° (μ: '25/26')
  selectedWeek,    // μ£Όμ°¨ (μ: '37')
  dsid             // λ°μ΄ν„°μ…‹ ID (κΈ°λ³Έκ°’: 'ds_0101')
);
```

**λ°ν™κ°’:**
- `influenzaData`: μΈν”λ£¨μ—”μ λ°μ΄ν„° κ°μ²΄
- `loading`: λ΅λ”© μƒνƒ
- `error`: μ—λ¬ λ©”μ‹μ§€

## π“ κ°λ° κ°€μ΄λ“

### μ½”λ“ κµ¬μ΅° μ›μΉ™

1. **κ΄€μ‹¬μ‚¬ λ¶„λ¦¬**: API λ΅μ§κ³Ό UI λ΅μ§μ„ λ¶„λ¦¬
   - API νΈμ¶: `hooks/useInfluenzaData.js`
   - UI λ λ”λ§: `components/Dashboard.js`

2. **μ¬μ‚¬μ© κ°€λ¥ν• ν›…**: λ°μ΄ν„° νμΉ­ λ΅μ§μ„ μ»¤μ¤ν…€ ν›…μΌλ΅ λ¶„λ¦¬ν•μ—¬ μ¬μ‚¬μ©

3. **μ ν‹Έλ¦¬ν‹° ν•¨μ**: κ³µν†µ λ΅μ§μ„ `utils/` λ””λ ‰ν† λ¦¬μ— λ¶„λ¦¬

### λ°μ΄ν„° νλ¦„

```
μ‚¬μ©μ μ•΅μ… (μ κΈ°/μ£Όμ°¨ μ„ νƒ)
    β†“
useInfluenzaData ν›…
    β†“
dateUtils.js (λ‚ μ§ λ²”μ„ κ³„μ‚°)
    β†“
etlDataApi.js (API νΈμ¶)
    β†“
auth.js (μΈμ¦ ν† ν° μ¶”κ°€)
    β†“
config.js (Axios μΈν„°μ…‰ν„°)
    β†“
API μ„λ²„
    β†“
dataProcessors.js (λ°μ΄ν„° μ²λ¦¬)
    β†“
Dashboard μ»΄ν¬λ„νΈ (UI λ λ”λ§)
```

### μ—λ¬ μ²λ¦¬

- API νΈμ¶ μ‹¤ν¨ μ‹ κΈ°λ³Έ λ”λ―Έ λ°μ΄ν„° ν‘μ‹
- μ‚¬μ©μμ—κ² λ…ν™•ν• μ—λ¬ λ©”μ‹μ§€ μ κ³µ
- μ½μ†”μ— μƒμ„Έν• μ—λ¬ λ΅κ·Έ μ¶λ ¥

### μ¤νƒ€μΌ κ°€μ΄λ“

- Material-UIμ `sx` propμ„ μ‚¬μ©ν• μ¤νƒ€μΌλ§
- μΌκ΄€λ μƒ‰μƒ ν”λ νΈ μ‚¬μ© (`#1570ef`, `#38bdf8` λ“±)
- λ°μ‘ν• λ””μμΈ κ³ λ ¤

## π› λ¬Έμ  ν•΄κ²°

### CORS μ¤λ¥

κ°λ° ν™κ²½μ—μ„ CORS μ¤λ¥κ°€ λ°μƒν•λ©΄:

1. κ°λ° μ„λ²„λ¥Ό μ¬μ‹μ‘ν•μ„Έμ” (`Ctrl+C` ν›„ `npm start`)
2. `setupProxy.js`κ°€ μ¬λ°”λ¥΄κ² μ„¤μ •λμ—λ”μ§€ ν™•μΈν•μ„Έμ”
3. λ°±μ—”λ“ μ„λ²„μ CORS μ„¤μ •μ„ ν™•μΈν•μ„Έμ”

### μΈμ¦ μ¤λ¥

μΈμ¦ κ΄€λ ¨ μ¤λ¥κ°€ λ°μƒν•λ©΄:

1. `.env` νμΌμ ν™κ²½ λ³€μκ°€ μ¬λ°”λ¥΄κ² μ„¤μ •λμ—λ”μ§€ ν™•μΈν•μ„Έμ”
2. Keycloak μ„λ²„κ°€ μ •μƒμ μΌλ΅ λ™μ‘ν•λ”μ§€ ν™•μΈν•μ„Έμ”
3. λΈλΌμ°μ € μ½μ†”μ—μ„ ν† ν° λ°κΈ‰ λ΅κ·Έλ¥Ό ν™•μΈν•μ„Έμ”

### API λ°μ΄ν„°κ°€ ν‘μ‹λμ§€ μ•μ

API λ°μ΄ν„°κ°€ ν‘μ‹λμ§€ μ•μΌλ©΄:

1. λΈλΌμ°μ € μ½μ†”μ—μ„ API νΈμ¶ λ΅κ·Έλ¥Ό ν™•μΈν•μ„Έμ”
2. API μ‘λ‹µ ν•μ‹μ΄ μμƒκ³Ό μΌμΉν•λ”μ§€ ν™•μΈν•μ„Έμ”
3. `processETLData` ν•¨μκ°€ μ¬λ°”λ¥΄κ² λ°μ΄ν„°λ¥Ό μ²λ¦¬ν•λ”μ§€ ν™•μΈν•μ„Έμ”

## π“„ λΌμ΄μ„ μ¤

μ΄ ν”„λ΅μ νΈλ” κµμ΅ λ©μ μΌλ΅ μ μ‘λμ—μµλ‹λ‹¤.

## π‘¥ κΈ°μ—¬

ν”„λ΅μ νΈ κ°μ„ μ„ μ„ν• μ μ•μ΄λ‚ λ²„κ·Έ λ¦¬ν¬νΈλ” μ΄μλ΅ λ“±λ΅ν•΄μ£Όμ„Έμ”.
